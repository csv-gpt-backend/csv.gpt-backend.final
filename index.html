<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Asistente GPT-5</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  body { font-family: Arial, sans-serif; max-width: 720px; margin: 40px auto; text-align: center; }
  textarea { width: 100%; height: 150px; padding: 10px; font-size: 15px; }
  button { padding: 10px 20px; margin-top: 10px; cursor: pointer; }
  .respuesta { margin-top: 20px; text-align: left; white-space: pre-wrap; border: 1px solid #ccc; padding: 10px; border-radius: 6px; }
  audio { margin-top: 15px; width: 100%; }
</style>
</head>
<body>
  <h2>Asistente GPT-5 (voz Salma ðŸ‡ªðŸ‡¸)</h2>

  <textarea id="pregunta" placeholder="Escribe tu pregunta..."></textarea><br>
  <button id="enviar">Enviar</button>

  <div class="respuesta" id="respuesta"></div>
  <audio id="voz" controls style="display:none;"></audio>

<script>
document.getElementById("enviar").onclick = async () => {
  const pregunta = document.getElementById("pregunta").value.trim();
  if (!pregunta) return alert("Escribe algo");

  const r = document.getElementById("respuesta");
  const v = document.getElementById("voz");
  r.textContent = "Consultando GPT-5...";
  v.style.display = "none";

  try {
    const resp = await fetch("/api/ask", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ q: pregunta })
    });

    const data = await resp.json().catch(() => ({}));
    if (!resp.ok) throw new Error(data?.error || "Error del servidor");

    r.textContent = data.text || "(sin texto)";
    if (data.audio) {
      v.src = data.audio;
      v.style.display = "block";
      try { await v.play(); } catch {}
    }
  } catch (err) {
    r.textContent = "Error: " + (err.message || err);
  }
};
</script>
</body>
</html>
